:root{
  --cell: 44px;
  --divider: 4px;
  --labelw: 140px;          /* MUST match JS labelWidth */
  --border: #b9b9b9;
  --header: #dfe6f3;
  --subheader: #cfd9ee;
  --bg: #f6f7fb;
  --dividerColor: #6d7aa5;
}

*{ box-sizing: border-box; }

body{
  margin: 0;
  font-family: Arial, sans-serif;
  background: var(--bg);
  color: #111;
}

/* ================= HEADER ================= */
.top{
  padding: 14px 14px 8px;
  text-align: center;
}
.top h1{ margin: 0 0 6px; font-size: 42px; }
.hint{ margin: 0; opacity: .75; font-size: 1rem; }

.controls{
  display: flex;
  gap: 10px;
  justify-content: center;
  align-items: center;
  padding-top: 10px;
}
.controls button{
  padding: 10px 14px;
  border: 1px solid #8f9bb8;
  background: #fff;
  border-radius: 10px;
  cursor: pointer;
  font-weight: 700;
}

.status{ font-weight: 700; }

/* ================= LAYOUT ================= */
.wrap{
  max-width: 1200px;
  margin: 0 auto;
  padding: 16px;
}

.sheet{
  display: grid;
  grid-template-columns: 1fr 420px;
  grid-template-rows: auto auto;
  gap: 18px;
}

/* worksheet blocks */
.block{
  background: #fff;
  border: 1px solid #999;
  padding: 10px;
  position: relative;
}

.block.main{
  grid-column: 1 / span 2;
}

.block.pastryTreat{
  margin-top: -18px;
}

.block-title{
  font-weight: 800;
  margin-bottom: 8px;
}

/* side labels */
.side-label{
  position: absolute;
  left: -42px;
  top: 50%;
  transform: translateY(-50%) rotate(-90deg);
  font-weight: 800;
  letter-spacing: 1px;
}

/* ================= GRID ================= */
.logic-grid{
  overflow-x: auto;
}

.grid{
  display: grid;
  border: 1px solid var(--border);
  background: #fff;
  width: max-content;
  position: relative;
}

/* base cell */
.cell{
  width: var(--cell);
  height: var(--cell);
  border: 1px solid var(--border);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 14px;
  user-select: none;
  position: relative;
  z-index: 2;
}

/* row labels */
.rowlabel{
  min-width: 120px;
  justify-content: flex-start;
  padding-left: 10px;
  font-weight: 800;
  background: var(--header);
}

/* column header cells */
.header{
  background: var(--header);
  font-weight: 800;
}

/* ================= TOP BAND (Flavour / Treat / Pastry) ================= */
.cell.band{
  height: 72px;
  padding: 6px 18px;
  background: #fff;

  /* CRITICAL: no borders = no text slicing */
  border: none;

  writing-mode: horizontal-tb;
  transform: none;

  justify-content: flex-start;
  align-items: center;

  /* draw only top & bottom lines */
  box-shadow:
    inset 0 1px 0 var(--border),
    inset 0 -1px 0 var(--border);
}

/* thick divider ONLY for group breaks */
.cell.band.band-divider{
  box-shadow:
    inset 0 1px 0 var(--border),
    inset 0 -1px 0 var(--border),
    inset calc(-1 * var(--divider)) 0 0 0 var(--dividerColor);
}

/* ================= VERTICAL COLUMN HEADERS ================= */
.grid > .cell.header:not(.rowlabel){
  writing-mode: vertical-rl;
  transform: rotate(180deg);
  height: 140px;
  font-size: 13px;
  padding: 6px 0;
  justify-content: flex-end;
}

/* never rotate band cells */
.grid > .cell.band{
  writing-mode: horizontal-tb !important;
  transform: none !important;
}

/* ================= CLICKABLE CELLS ================= */
.clickable{ cursor: pointer; }
.clickable:hover{ background: #f0f3ff; }

.x{ color: #d11; font-weight: 900; }
.check{ color: #0a8f3c; font-weight: 900; }

/* ================= FULL-HEIGHT DIVIDERS ================= */
#mainGrid .grid::before{
  content: "";
  position: absolute;
  inset: 0;
  pointer-events: none;
  z-index: 1;
  background-repeat: no-repeat;
  background-image:
    linear-gradient(to right,
      transparent calc(var(--labelw) + (5 * var(--cell))),
      var(--dividerColor) calc(var(--labelw) + (5 * var(--cell))),
      var(--dividerColor) calc(var(--labelw) + (5 * var(--cell)) + var(--divider)),
      transparent calc(var(--labelw) + (5 * var(--cell)) + var(--divider))
    ),
    linear-gradient(to right,
      transparent calc(var(--labelw) + (10 * var(--cell))),
      var(--dividerColor) calc(var(--labelw) + (10 * var(--cell))),
      var(--dividerColor) calc(var(--labelw) + (10 * var(--cell)) + var(--divider)),
      transparent calc(var(--labelw) + (10 * var(--cell)) + var(--divider))
    );
}

/* ================= MOBILE ================= */
@media (max-width: 900px){
  .sheet{
    grid-template-columns: 1fr;
    grid-template-rows: auto auto auto;
  }
}
